<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title></title>
<!-- styles unchanged -->
</head>
<body>
<div class="container">
  <aside class="panel" aria-labelledby="panel-title">
    <div class="brand">
      <div id="logoText" class="logo" aria-hidden="true"></div>
      <div>
        <h1 id="panel-title"></h1>
        <p id="panel-subtitle"></p>
      </div>
    </div>

    <div id="panel-meta" class="meta"></div>

    <div class="left-rows">
      <div class="row">
        <div id="emailText" class="text-box"></div>
        <button id="copyBtn" class="action-btn copy-btn"></button>
      </div>

      <div class="row">
        <div id="shopText" class="text-box"></div>
        <a id="shopBtn" class="action-btn shop-btn" target="_blank" rel="noopener"></a>
      </div>

      <div id="panel-tip" class="small-note"></div>
    </div>
  </aside>

  <main class="card">
    <div class="card-header">
      <div class="title">
        <h2 id="main-title"></h2>
        <p id="subtitle"></p>
      </div>

      <div class="controls">
        <input id="searchInput" class="search"/>
        <div class="last-updated-box">
          <div class="label">Last updated:</div>
          <div class="date" id="lastUpdated"></div>
        </div>
      </div>
    </div>

    <div id="accordion" class="accordion"></div>

    <div class="card-footer">
      <div>
        <div id="agreementNote"></div>
        <div class="pill" id="sourceAttribution"></div>
      </div>
      <button id="savePdfBtn" class="pdf-icon-btn"></button>
    </div>
  </main>
</div>

<script>
const SOURCE = "terms.json";

fetch(SOURCE,{cache:"no-store"})
.then(r=>r.json())
.then(data=>{
  logoText.textContent = data.brand.logoText;
  panelTitle.textContent = data.brand.brandTitle;
  panelSubtitle.textContent = data.brand.brandSubtitle;
  panelMeta.textContent = data.brand.meta;
  panelTip.textContent = data.brand.tip;

  mainTitle.textContent = data.title;
  subtitle.textContent = data.subtitle;
  searchInput.placeholder = data.ui.searchPlaceholder;
  lastUpdated.textContent = data.lastUpdated;

  emailText.textContent = data.contact.email;
  shopText.textContent = data.contact.shop;
  shopBtn.href = data.contact.shop;

  agreementNote.textContent = data.ui.agreementNote;
  sourceAttribution.textContent = data.ui.sourceAttribution;
  copyBtn.title = data.ui.copyEmailTooltip;
  shopBtn.title = data.ui.openShopTooltip;
  savePdfBtn.title = data.ui.savePdfTooltip;

  accordion.innerHTML="";
  data.sections.forEach((s,i)=>{
    const sec=document.createElement("section");
    sec.className="section";
    sec.innerHTML=`<div class="section-header"><strong>${s.title}</strong></div><div class="section-body"></div>`;
    const body=sec.querySelector(".section-body");
    if(Array.isArray(s.body)) s.body.forEach(p=>body.innerHTML+=`<p>${p}</p>`);
    else if(typeof s.body==="string") body.innerHTML=`<p>${s.body}</p>`;
    else{
      body.innerHTML=`<p>${s.body.intro}</p><ul>${s.body.items.map(i=>`<li>${i}</li>`).join("")}</ul>`;
    }
    accordion.appendChild(sec);
  });
});
</script>
</body>
</html>
